$cat [G1.txt]
  group_1: PRJNA422916_pep|FIzeb_PRJNA422916.DN23349.c0.g1.i10.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN23349.c0.g1.i7.p1 PRJNA381689_pep|FIswo_PRJNA381689.DN13573.c0.g1.i1.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN11237.c0.g1.i9.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN3760.c2.g1.i4.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN49428.c0.g1.i1.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN49428.c0.g1.i10.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN49428.c0.g1.i12.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN49428.c0.g1.i13.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN49428.c0.g1.i3.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN49428.c0.g1.i6.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN49428.c0.g1.i9.p1 PRJNA381689_pep|FIswo_PRJNA381689.DN15997.c2.g1.i1.p1 PRJNA381689_pep|FIswo_PRJNA381689.DN2337.c0.g1.i1.p1 PRJNA381689_pep|FIswo_PRJNA381689.DN7322.c1.g1.i2.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN11504.c0.g1.i6.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN14677.c0.g1.i1.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN19855.c0.g2.i1.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN23349.c0.g1.i5.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN3001.c0.g1.i1.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN3001.c0.g1.i11.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN3001.c0.g1.i12.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN3001.c0.g1.i17.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN3001.c0.g1.i6.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN3760.c0.g1.i2.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN3760.c0.g1.i4.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN3979.c0.g1.i1.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN3979.c0.g1.i4.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN3979.c0.g1.i7.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN4055.c1.g1.i2.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN42743.c0.g1.i1.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN6205.c0.g3.i1.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN7267.c0.g1.i7.p1 PRJNA381689_pep|FIswo_PRJNA381689.DN24261.c0.g1.i1.p1 PRJNA381689_pep|FIswo_PRJNA381689.DN7322.c1.g1.i1.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN1000.c0.g4.i1.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN14729.c0.g1.i1.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN28272.c0.g1.i1.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN28272.c0.g1.i6.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN39648.c0.g2.i4.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN5149.c0.g1.i3.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN65268.c0.g1.i2.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN6664.c1.g1.i5.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN11639.c0.g2.i1.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN23756.c1.g1.i3.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN23756.c1.g1.i4.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN23756.c1.g1.i5.p2 PRJNA422916_pep|FIzeb_PRJNA422916.DN23756.c1.g1.i7.p2 PRJNA422916_pep|FIzeb_PRJNA422916.DN25438.c0.g1.i1.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN38734.c0.g1.i1.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN38734.c0.g1.i3.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN4140.c1.g4.i1.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN6016.c0.g1.i1.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN8158.c0.g1.i3.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN9474.c0.g2.i4.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN10266.c0.g1.i2.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN19616.c0.g1.i2.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN19621.c1.g1.i1.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN41508.c0.g1.i7.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN10231.c0.g1.i3.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN10318.c0.g1.i2.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN104673.c0.g1.i1.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN10795.c0.g1.i1.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN10795.c0.g1.i2.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN11112.c0.g1.i1.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN12454.c0.g1.i2.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN12552.c0.g2.i1.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN13289.c0.g1.i6.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN13410.c0.g1.i6.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN13410.c0.g1.i9.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN13447.c0.g1.i2.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN13447.c0.g1.i3.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN13447.c0.g1.i4.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN13447.c0.g1.i9.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN14190.c0.g1.i6.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN1622.c1.g1.i4.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN1622.c1.g1.i7.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN1622.c1.g1.i8.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN17725.c0.g1.i2.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN18459.c0.g1.i2.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN1910.c1.g3.i2.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN19855.c0.g2.i3.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN19855.c0.g2.i5.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN23629.c0.g1.i8.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN23756.c1.g1.i2.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN27190.c0.g1.i3.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN27190.c0.g1.i8.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN3248.c0.g1.i9.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN34695.c0.g1.i3.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN3588.c0.g1.i3.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN3588.c0.g1.i5.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN39648.c0.g2.i3.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN41101.c0.g1.i2.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN41101.c0.g1.i6.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN4296.c0.g1.i14.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN4296.c0.g1.i2.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN4296.c0.g1.i3.p2 PRJNA422916_pep|FIzeb_PRJNA422916.DN4296.c0.g1.i8.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN4296.c0.g1.i9.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN43925.c0.g1.i7.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN45409.c0.g1.i3.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN45409.c0.g1.i6.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN4587.c1.g1.i11.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN4587.c1.g1.i6.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN46932.c0.g1.i1.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN5022.c0.g4.i4.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN5149.c0.g1.i6.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN5873.c0.g1.i12.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN5873.c0.g1.i9.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN5974.c1.g1.i1.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN6664.c1.g1.i6.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN6664.c1.g1.i7.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN69508.c0.g1.i1.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN69508.c0.g1.i3.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN7267.c0.g1.i6.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN816.c1.g1.i2.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN816.c1.g1.i6.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN8432.c0.g2.i1.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN8432.c0.g4.i1.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN8432.c0.g4.i2.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN8189.c0.g4.i1.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN92102.c0.g1.i1.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN20927.c1.g2.i3.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN16457.c0.g1.i3.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN24486.c0.g1.i1.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN10243.c0.g3.i1.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN10243.c0.g3.i2.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN10795.c0.g1.i3.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN11432.c0.g1.i1.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN12281.c0.g2.i6.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN12454.c0.g1.i3.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN12454.c0.g1.i5.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN131126.c0.g1.i1.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN14216.c0.g1.i12.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN1558.c2.g1.i3.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN16650.c0.g1.i2.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN16650.c0.g1.i5.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN17725.c0.g1.i15.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN19855.c0.g2.i2.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN2293.c0.g1.i13.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN23040.c1.g1.i1.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN23756.c1.g1.i6.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN23756.c1.g1.i7.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN24512.c0.g1.i6.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN26230.c0.g1.i9.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN26271.c0.g1.i7.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN29003.c0.g1.i17.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN29003.c0.g1.i9.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN294.c1.g1.i2.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN294.c1.g1.i3.p1 PRJNA422916_pep|FIzeb_PRJNA422916.DN294.c1.g1.i6.p1 ...

$sed "s/ P/\nP/g" [G1.txt] | tail -n +2 > [g1_allr.pepname]

$cat [g1_allr.pepname]
  PRJNA422916_pep|FIzeb_PRJNA422916.DN23349.c0.g1.i10.p1
  PRJNA422916_pep|FIzeb_PRJNA422916.DN23349.c0.g1.i7.p1
  PRJNA381689_pep|FIswo_PRJNA381689.DN13573.c0.g1.i1.p1
  PRJNA422916_pep|FIzeb_PRJNA422916.DN11237.c0.g1.i9.p1
  PRJNA422916_pep|FIzeb_PRJNA422916.DN3760.c2.g1.i4.p1
  PRJNA422916_pep|FIzeb_PRJNA422916.DN49428.c0.g1.i1.p1
  PRJNA422916_pep|FIzeb_PRJNA422916.DN49428.c0.g1.i10.p1
  PRJNA422916_pep|FIzeb_PRJNA422916.DN49428.c0.g1.i12.p1
  PRJNA422916_pep|FIzeb_PRJNA422916.DN49428.c0.g1.i13.p1
  PRJNA422916_pep|FIzeb_PRJNA422916.DN49428.c0.g1.i3.p1
  ...

$for line in `cat [g1_allr.pepname]`; do \
  trimmed=`echo $line | cut -d'|' -f 2`; \
  echo ${trimmed%.p*}; \
  done

  FIzeb_PRJNA422916.DN23349.c0.g1.i10
  FIzeb_PRJNA422916.DN23349.c0.g1.i7
  FIswo_PRJNA381689.DN13573.c0.g1.i1
  FIzeb_PRJNA422916.DN11237.c0.g1.i9
  FIzeb_PRJNA422916.DN3760.c2.g1.i4
  FIzeb_PRJNA422916.DN49428.c0.g1.i1
  FIzeb_PRJNA422916.DN49428.c0.g1.i10
  FIzeb_PRJNA422916.DN49428.c0.g1.i12
  FIzeb_PRJNA422916.DN49428.c0.g1.i13
  FIzeb_PRJNA422916.DN49428.c0.g1.i3
  ...
$for line in `cat [g1_10r.pepname]`; do \
  trimmed=`echo $line | cut -d'|' -f 2`; \
  echo ${trimmed%.p*}; \
  isoform=${trimmed%.p*}; \
  awk -v pat="$isoform" '{ if ($0 ~ pat) {print; getline; print;} }' ../../fasta_dir/* >> [g1_10r.dnaseq.fasta];\
  done


#----------------------------------------------------------------------
$echo `head -1 [g10.counts.stat]` SUM > allsp_g.counts.stat

$awk '{for(i=2;i<=NF;i++){if($i+0 < 1) next}} 1' [g10.counts.stat] | awk '{sum=0; for (i=2; i<=NF; i++) { sum+= $i } print $0,sum}' >> allsp_g.counts.stat

$cat allsp_g.counts.stat
  GROUP_NUM PRJNA422916 PRJNA381689 SUM
  group_1: 513 6 519
  group_4: 288 1 289
  group_5: 218 29 247
  group_7: 220 1 221
  group_8: 183 25 208
  group_9: 154 20 174
  group_10: 151 12 163

$awk '{for(i=2;i<=NF;i++){if($i+0 < 1) next}} 1' [g10.counts.stat] | awk '{ print $1 }' > tmp.allsp_g.lst

$cat tmp.allsp_g.lst
  group_1:
  group_4:
  group_5:
  group_7:
  group_8:
  group_9:
  group_10:
  ...

$for line in `cat [tmp.allsp_g.lst]`; do \
  awk -v pat="$line" '{ if ($0 ~ pat) {print} }' ../groups.txt > ../[allsp_groups.txt] ;\
  done







#!/bin/bash
#=======================================================================================================
############################
# orthomcl results summary #
############################


function ortho_pepstat() {
  # in the *_lst/ directory
  echo "Path : "$(pwd)
  file=`basename $(pwd)`
  echo "Taxonomy Group Name : "${file%_lst}
  echo

  ### step1 : count the total number of clustering groups in a Taxonomy group
  TOTAL_GP_COUNT=`grep -c "group" output/groups/groups.txt`
  echo "Total clustering groups : "${TOTAL_GP_COUNT}
  echo

  ### step2 : counts of proteins for each species in each cluster group
###########
# cat output/groups/groups.txt | \
# awk 'BEGIN {print "GROUP_NUM", "PRJNA?????1", "PRJNA?????2", "PRJNA?????3", "PRJNA?????4", "PRJNA?????5", "PRJNA?????6", "PRJNA?????7", "PRJNA?????8", "PRJNA?????9", "PRJNA????10"}
# { sp1=sp2=sp3=sp4=sp5=sp6=sp7=sp8=sp9=sp10=0; for(i=2; i<=NF; i++) \
# if ($i ~ "PRJNA?????1") sp1 += 1; \
# else if ($i ~ "PRJNA?????2") sp2 += 1; \
# else if ($i ~ "PRJNA?????3") sp3 += 1; \
# else if ($i ~ "PRJNA?????4") sp4 += 1; \
# else if ($i ~ "PRJNA?????5") sp5 += 1; \
# else if ($i ~ "PRJNA?????6") sp6 += 1; \
# else if ($i ~ "PRJNA?????7") sp7 += 1; \
# else if ($i ~ "PRJNA?????8") sp8 += 1; \
# else if ($i ~ "PRJNA?????9") sp9 += 1; \
# else if ($i ~ "PRJNA????10") sp10 += 1; \
# print $1, sp1, sp2, sp3, sp4, sp5, sp6, sp7, sp8, sp9, sp10 }' > ./analyze/groups.pepcounts.txt
###########

  ### step3 : count unclustered/clustered sequences per species
  study_all=`ls -1 input/*_pep.fasta | wc -l`
  echo "Amount Of Species : "${study_all}
  echo
  # generate a output file to hold the starts
  echo  "Species_Acc" "Count_Totalpep" "Count_Clustered" "Count_Unclustered" > ./analyze/cluster.pepstat  # HEADER
  i=1
  for file in `ls -1 ./input/*_pep.fasta`; do
    file=`basename $file`
    sp_name=${file%_pep.fasta}
    echo "SPECIES "$i " Name : "${sp_name}
    echo
    # amount of all pep sequences (per species)
    SP_OR_CNT=`wc -l < ./analyze/orgin_${sp_name%_pep}.lst`
    echo "SPECIES "$i " total pep sequences : "${SP_OR_CNT}
    echo
    # amount of clustered pep sequences (per species)
    SP_CL_CNT=`wc -l < ./analyze/clustered_${sp_name%_pep}.lst`
    echo "SPECIES "$i " clustered pep sequences : "${SP_CL_CNT}
    echo
    # amount of unclustered pep sequences (per species)
    SP_UN_CNT=`wc -l < ./analyze/unclustered_${sp_name%_pep}.lst`
    echo "SPECIES "$i " unclustered pep sequences : "${SP_UN_CNT}
    echo
    # hold the stats to output file
    # awk -v name="${sp_name}" -v total="${SP_OR_CNT}" -v clustered="${SP_CL_CNT}" -v unclustered="${SP_UN_CNT}" '{ print name,total, clustered, unclustered }' >> cluster.stat
    echo ${sp_name} ${SP_OR_CNT} ${SP_CL_CNT} ${SP_UN_CNT} >>./analyze/cluster.pepstat
    let i=i+1
  done
}


function ortho_allsp_g() {
  #in the *_lst/ directory
  cd analyze/stat/
  echo `head -1 groups.counts.stat` SUM > allsp_g.counts.stat

  awk '{for(i=2;i<=NF;i++){if($i+0 < 1) next}} 1' groups.counts.stat | awk '{sum=0; for (i=2; i<=NF; i++) { sum+= $i } print $0,sum}' >> allsp_g.counts.stat

  awk '{for(i=2;i<=NF;i++){if($i+0 < 1) next}} 1' groups.counts.stat | awk '{ print $1 }' > tmp.allsp_g.lst

  while IFS= read -r line; do
    awk -v pat="$line" '{ if ($0 ~ pat) {print} }' ../../output/groups/groups.txt >> ../allsp_groups.txt
  done < tmp.allsp_g.lst
  rm tmp.allsp_g.lst
  cd ../../
}


function ortho_perg_seq() {
  #in the *_lst/ directory
  # check if the fasta files prepared
  if [ ! -d fasta_dir/ ]; then
    mkdir fasta_dir
    for file in `ls -1 ./input/*_pep.fasta`; do
      file=`basename $file`
      file=${file%_pep.fasta}"_RSEM.fasta"
      echo ${file}
      find /media/lewis/Seagate_Backup_Plus_Drive/ruby/data/ -name ${file} -exec cp -v {} fasta_dir/ \;
    done
  fi

  # randomly select 10 (test with 2) groups to test the similarity of sequences in groups
  cd analyze/
  mkdir per_group
  cd per_group
  shuf -n 2 ../../output/groups/groups.txt > 10g_groups.txt  # test all groups
  while IFS= read -r line; do
    echo ${line} > 10g_pergroup.txt
    group_num=`awk '{print $1}' 10g_pergroup.txt`
    group_num=${group_num%:}
    echo ${group_num}
    sed "s/ P/\nP/g" 10g_pergroup.txt | tail -n +2 > 10g_pergroup.pepname

    while IFS= read -r line; do
      trimmed=`echo $line | cut -d'|' -f 2`
      echo ${trimmed%.p*}
      isoform=${trimmed%.p*}
      awk -v pat="$isoform" '{ if ($0 ~ pat) {print; getline; print;} }' ../../fasta_dir/* >> 10g_pergroup.danseq.fasta
    done < 10g_pergroup.pepname

    output=$group_num".danseq.fasta"
    mv 10g_pergroup.danseq.fasta ${output}
    rm 10g_pergroup*
  done < 10g_groups.txt


  shuf -n 2 ../allsp_groups.txt > allsp_10g_groups.txt  # only test those all-species-included groups
  while IFS= read -r line; do
    echo ${line} > 10g_pergroup.txt
    group_num=`awk '{print $1}' 10g_pergroup.txt`
    group_num=${group_num%:}
    echo ${group_num}
    sed "s/ P/\nP/g" 10g_pergroup.txt | tail -n +2 > 10g_pergroup.pepname

    while IFS= read -r line; do
      trimmed=`echo $line | cut -d'|' -f 2`
      echo ${trimmed%.p*}
      isoform=${trimmed%.p*}
      awk -v pat="$isoform" '{ if ($0 ~ pat) {print; getline; print;} }' ../../fasta_dir/* >> 10g_pergroup.danseq.fasta
    done < 10g_pergroup.pepname

    output="allsp_"$group_num".danseq.fasta"
    mv 10g_pergroup.danseq.fasta ${output}
    rm 10g_pergroup*
  done < allsp_10g_groups.txt
  cd ../../

}

# step1
#sudo chmod 777 output/groups/*
#ortho_pepsum 2>&1 | tee ortho_pepsum.log
#ortho_pepstat 2>&1 | tee ortho_pepstat.log
#mkdir analyze/stat/
#mv analyze/groups.pepcounts.txt analyze/stat/groups.pepcounts.stat
#mv analyzegroups/cluster.pepstat analyze/stat/cluster.pepstat

# step2
ortho_allsp_g

# step3
ortho_perg_seq
